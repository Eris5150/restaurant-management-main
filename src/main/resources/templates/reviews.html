<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: header}"></head>
<body>

<!-- =========================== Navigation Bar =========================== -->
<nav>
    <ul>
        <li><a th:href="@{/}">Dashboard</a></li>
        <li><a th:href="@{/menu}">Manage Menu</a></li>
        <li><a th:href="@{/inventory}">Manage Inventory</a></li>
        <li><a th:href="@{/order}">Manage Orders</a></li>
        <li><a th:href="@{/reviews}">Reviews</a></li>
        <!-- Auth-aware links: Login for anonymous, username/role + Logout for authenticated -->
        <li th:if="${#authentication.name == 'anonymousUser'}">
            <a th:href="@{/login}">Login</a>
        </li>
        <li class="username" th:if="${#authentication.name != 'anonymousUser'}">
            Welcome, <span th:text="${#authentication.principal.username}">User</span>
            (<span th:text="${#authentication.authorities[0].authority.replace('ROLE_', '')}">Role</span>) |
            <a th:href="@{/logout}">Logout</a>
        </li>
    </ul>
</nav>

<!-- =========================== Page Header =========================== -->
<header>
    <h1>Reviews</h1>
</header>

<!-- =========================== Main Content =========================== -->
<main>
    <!-- Reviews table: lists author, rating, and optional description -->
    <table>
        <thead>
        <tr>
            <th>Author</th>
            <th>Rating</th>
            <th>Description</th>
        </tr>
        </thead>
        <tbody>
        <!-- Row binding for each review -->
        <tr th:each="review : ${reviews}">
            <td th:text="${review.getAuthor()}"></td>
            <td th:text="${review.getRating()}"></td>
            <!-- Show description when provided; otherwise render a friendly fallback -->
            <td th:if="${review.getDescription() != ''}" th:text="${review.getDescription()}"></td>
            <td th:if="${review.getDescription() == ''}" th:text="'No description provided for this review'" id="no-desc-review"></td>
        </tr>
        </tbody>
    </table>
</main>

<!-- =========================== Footer =========================== -->
<div th:replace="~{fragments/footer :: footer}"></div>

</body>
</html>
